#tcda-sra-1-1874.fa generated processing SRA alignment generated by M. Mansfield - see diffBase-SRA repository
cp ../../OriginalData/TcdA/tcdA_relabeled_1-1874.afa tcda-ncbi.fa

makeblastdb -in tcda-ncbi.fa -dbtype 'prot'

#BLAST SRA sequences against NCBI refs
blastp -outfmt "6" -query tcda-sra-1-1874.fa -db tcda-ncbi.fa >tcda-blast.out

perl parseBLASToutput.pl tcda-blast.out >sra-vs-ncbi.txt

#create plot in R -> plot.R


#extracted the novel SRAs in the sra-vs-ncbi.txt file (those with non 100% identities)
# cat sra-vs-ncbi.txt | sort -k3 -n   # then just copy and paste top of list
#placed in file novelSRAs-tcda.txt

perl relabel_novelSRAs.pl novelSRAs-tcda.txt tcda-sra-1-1874.fa >novelSRAs-tcda.fa

#will now manually decide on labels for the ?

cat novelSRAs-tcda.fa tcda-ncbi.fa >ncbi_plus_sra_tcda.fa

#inspect alignment, build tree and decide on new labels

# SRA_TcdA_SRS1496955_3432.A/1-1874   -- assigned A
# SRA_TcdA_SRS1486236_3725.?/1-1874   -- assigned B
# SRA_TcdA_SRS1486256_3715.?/1-1874   -- assigned B
# SRA_TcdA_SRS1377248_3700.?/1-1874   -- assigned new label G
# SRA_TcdA_SRS1486661_3824.?/1-1874   -- assigned new label H

#removed five SRAs based on 100% redundancy and assigned labels above to unclassified "?" SRA sequence
ncbi_plus_sra_tcda_edited.fa

#built tree in R

aln <- read.alignment("ncbi_plus_sra_tcda.fa","fasta")
tree <- bionj(dist.alignment(aln,matrix="similarity"))
tree <- ladderize(midpoint.root(tree))
write.tree(tree,file="~/Downloads/tcda_ncbiAndSRA.newick")

